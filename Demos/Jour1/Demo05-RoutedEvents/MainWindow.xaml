<Window x:Class="RoutedEventsDemo.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Démo - Routed Events (Bubbling, Tunneling, Direct)"
        Height="700" Width="900"
        Background="#F5F5F5">

    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- En-tête -->
        <StackPanel Margin="0,0,0,20">
            <TextBlock Text="Routed Events dans WPF"
                      FontSize="28" FontWeight="Bold"
                      Foreground="#2C3E50"/>
            <TextBlock Text="Démonstration du Bubbling, Tunneling et des événements Direct"
                      Foreground="Gray"/>
        </StackPanel>

        <!-- Contenu principal -->
        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="300"/>
            </Grid.ColumnDefinitions>

            <!-- Zone de démonstration -->
            <Border Background="White" CornerRadius="8" Padding="20" Margin="0,0,20,0">
                <Border.Effect>
                    <DropShadowEffect BlurRadius="10" ShadowDepth="2"
                                     Opacity="0.1" Color="Black"/>
                </Border.Effect>

                <StackPanel>
                    <TextBlock Text="Zone Interactive"
                              FontSize="18" FontWeight="SemiBold"
                              Margin="0,0,0,20"/>

                    <!-- Hiérarchie imbriquée pour démontrer le routage -->
                    <Border x:Name="OuterBorder"
                           Background="#E3F2FD"
                           BorderBrush="#2196F3"
                           BorderThickness="2"
                           CornerRadius="8"
                           Padding="20"
                           PreviewMouseDown="OuterBorder_PreviewMouseDown"
                           MouseDown="OuterBorder_MouseDown">

                        <StackPanel>
                            <TextBlock Text="Border Externe (OuterBorder)"
                                      FontWeight="SemiBold"
                                      Foreground="#1565C0"
                                      Margin="0,0,0,15"/>

                            <Border x:Name="MiddleBorder"
                                   Background="#E8F5E9"
                                   BorderBrush="#4CAF50"
                                   BorderThickness="2"
                                   CornerRadius="8"
                                   Padding="20"
                                   PreviewMouseDown="MiddleBorder_PreviewMouseDown"
                                   MouseDown="MiddleBorder_MouseDown">

                                <StackPanel>
                                    <TextBlock Text="Border Milieu (MiddleBorder)"
                                              FontWeight="SemiBold"
                                              Foreground="#2E7D32"
                                              Margin="0,0,0,15"/>

                                    <Border x:Name="InnerBorder"
                                           Background="#FFF3E0"
                                           BorderBrush="#FF9800"
                                           BorderThickness="2"
                                           CornerRadius="8"
                                           Padding="20"
                                           PreviewMouseDown="InnerBorder_PreviewMouseDown"
                                           MouseDown="InnerBorder_MouseDown">

                                        <StackPanel>
                                            <TextBlock Text="Border Interne (InnerBorder)"
                                                      FontWeight="SemiBold"
                                                      Foreground="#E65100"
                                                      Margin="0,0,0,10"/>

                                            <Button x:Name="ActionButton"
                                                   Content="Cliquez-moi !"
                                                   Padding="20,10"
                                                   FontSize="14"
                                                   PreviewMouseDown="ActionButton_PreviewMouseDown"
                                                   Click="ActionButton_Click"/>
                                        </StackPanel>
                                    </Border>
                                </StackPanel>
                            </Border>
                        </StackPanel>
                    </Border>

                    <!-- Options -->
                    <StackPanel Orientation="Horizontal" Margin="0,20,0,0">
                        <CheckBox x:Name="StopTunnelingCheckBox"
                                 Content="Arrêter le Tunneling au niveau Milieu"
                                 Margin="0,0,20,0"/>
                        <CheckBox x:Name="StopBubblingCheckBox"
                                 Content="Arrêter le Bubbling au niveau Milieu"/>
                    </StackPanel>

                    <Button Content="Effacer le journal"
                           Click="ClearLog_Click"
                           HorizontalAlignment="Left"
                           Padding="15,8"
                           Margin="0,10,0,0"/>
                </StackPanel>
            </Border>

            <!-- Journal des événements -->
            <Border Grid.Column="1" Background="White" CornerRadius="8" Padding="15">
                <Border.Effect>
                    <DropShadowEffect BlurRadius="10" ShadowDepth="2"
                                     Opacity="0.1" Color="Black"/>
                </Border.Effect>

                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <TextBlock Text="Journal des Événements"
                              FontSize="16" FontWeight="SemiBold"
                              Margin="0,0,0,10"/>

                    <ListBox x:Name="EventLog"
                            Grid.Row="1"
                            BorderThickness="1"
                            BorderBrush="#E0E0E0"
                            FontFamily="Consolas"
                            FontSize="11">
                        <ListBox.ItemTemplate>
                            <DataTemplate>
                                <TextBlock Text="{Binding}"
                                          TextWrapping="Wrap"
                                          Margin="0,2"/>
                            </DataTemplate>
                        </ListBox.ItemTemplate>
                    </ListBox>
                </Grid>
            </Border>
        </Grid>

        <!-- Légende -->
        <Border Grid.Row="2" Background="White" CornerRadius="8" Padding="15" Margin="0,20,0,0">
            <Border.Effect>
                <DropShadowEffect BlurRadius="10" ShadowDepth="2"
                                 Opacity="0.1" Color="Black"/>
            </Border.Effect>

            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <!-- Tunneling -->
                <StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,5">
                        <Border Background="#9C27B0" Width="20" Height="20"
                               CornerRadius="4" Margin="0,0,8,0"/>
                        <TextBlock Text="Tunneling (Preview*)"
                                  FontWeight="SemiBold" VerticalAlignment="Center"/>
                    </StackPanel>
                    <TextBlock Text="De la racine vers la cible.&#x0a;Permet d'intercepter avant."
                              Foreground="Gray" FontSize="12" TextWrapping="Wrap"/>
                </StackPanel>

                <!-- Bubbling -->
                <StackPanel Grid.Column="1" Margin="20,0">
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,5">
                        <Border Background="#2196F3" Width="20" Height="20"
                               CornerRadius="4" Margin="0,0,8,0"/>
                        <TextBlock Text="Bubbling"
                                  FontWeight="SemiBold" VerticalAlignment="Center"/>
                    </StackPanel>
                    <TextBlock Text="De la cible vers la racine.&#x0a;Mode par défaut (MouseDown, Click)."
                              Foreground="Gray" FontSize="12" TextWrapping="Wrap"/>
                </StackPanel>

                <!-- Direct -->
                <StackPanel Grid.Column="2">
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,5">
                        <Border Background="#4CAF50" Width="20" Height="20"
                               CornerRadius="4" Margin="0,0,8,0"/>
                        <TextBlock Text="Direct"
                                  FontWeight="SemiBold" VerticalAlignment="Center"/>
                    </StackPanel>
                    <TextBlock Text="Uniquement sur l'élément cible.&#x0a;Ex: MouseEnter, Loaded."
                              Foreground="Gray" FontSize="12" TextWrapping="Wrap"/>
                </StackPanel>
            </Grid>
        </Border>
    </Grid>
</Window>
