<Window x:Class="DIDemo.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Démo - Injection de Dépendances"
        Height="650" Width="900"
        Background="#F5F5F5">

    <Grid Margin="20">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <!-- Colonne gauche: Interaction -->
        <StackPanel Margin="0,0,10,0">

            <!-- Section Message Service -->
            <Border Background="White" CornerRadius="8" Padding="20" Margin="0,0,0,15">
                <Border.Effect>
                    <DropShadowEffect BlurRadius="10" ShadowDepth="2" Opacity="0.1"/>
                </Border.Effect>

                <StackPanel>
                    <TextBlock Text="IMessageService (Singleton)"
                              FontSize="18" FontWeight="SemiBold"
                              Foreground="#2C3E50" Margin="0,0,0,15"/>

                    <TextBlock Text="VOTRE NOM" FontSize="11" FontWeight="SemiBold"
                              Foreground="#7F8C8D" Margin="0,0,0,5"/>
                    <TextBox Text="{Binding UserName, UpdateSourceTrigger=PropertyChanged}"
                            Padding="12,10" Margin="0,0,0,15"/>

                    <StackPanel Orientation="Horizontal" Margin="0,0,0,15">
                        <Button Content="Dire Bonjour"
                               Command="{Binding SayHelloCommand}"
                               Padding="15,10" Margin="0,0,10,0"
                               Background="#3498DB" Foreground="White"/>
                        <Button Content="Dire Au revoir"
                               Command="{Binding SayGoodbyeCommand}"
                               Padding="15,10"
                               Background="#E74C3C" Foreground="White"/>
                    </StackPanel>

                    <!-- Message affiché -->
                    <Border Background="#E8F5E9" CornerRadius="4" Padding="15"
                           Visibility="{Binding CurrentMessage, Converter={StaticResource StringToVis}}">
                        <TextBlock Text="{Binding CurrentMessage}"
                                  FontSize="14" Foreground="#2E7D32"
                                  TextWrapping="Wrap"/>
                    </Border>
                </StackPanel>
            </Border>

            <!-- Section Data Service -->
            <Border Background="White" CornerRadius="8" Padding="20">
                <Border.Effect>
                    <DropShadowEffect BlurRadius="10" ShadowDepth="2" Opacity="0.1"/>
                </Border.Effect>

                <StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,15">
                        <TextBlock Text="IDataService (Singleton)"
                                  FontSize="18" FontWeight="SemiBold"
                                  Foreground="#2C3E50"/>
                        <TextBlock Text=" - données partagées"
                                  FontSize="14" Foreground="Gray"
                                  VerticalAlignment="Bottom"/>
                    </StackPanel>

                    <!-- Ajout d'item -->
                    <Grid Margin="0,0,0,10">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <TextBox Text="{Binding NewItem, UpdateSourceTrigger=PropertyChanged}"
                                Padding="10,8"/>
                        <Button Grid.Column="1" Content="Ajouter"
                               Command="{Binding AddItemCommand}"
                               Padding="15,8" Margin="10,0,0,0"
                               Background="#27AE60" Foreground="White"/>
                    </Grid>

                    <!-- Liste des items -->
                    <ListBox ItemsSource="{Binding Items}"
                            Height="150" Margin="0,0,0,10"/>

                    <Button Content="Recharger"
                           Command="{Binding LoadItemsCommand}"
                           HorizontalAlignment="Left"
                           Padding="15,8"/>

                    <!-- Indicateur de chargement -->
                    <TextBlock Text="Chargement..."
                              Foreground="#F39C12" FontStyle="Italic"
                              Margin="0,5,0,0"
                              Visibility="{Binding IsLoading, Converter={StaticResource BoolToVis}}"/>
                </StackPanel>
            </Border>
        </StackPanel>

        <!-- Colonne droite: Logs et explications -->
        <StackPanel Grid.Column="1" Margin="10,0,0,0">

            <!-- Logs -->
            <Border Background="White" CornerRadius="8" Padding="20" Margin="0,0,0,15">
                <Border.Effect>
                    <DropShadowEffect BlurRadius="10" ShadowDepth="2" Opacity="0.1"/>
                </Border.Effect>

                <StackPanel>
                    <TextBlock Text="Journal d'activité"
                              FontSize="16" FontWeight="SemiBold"
                              Foreground="#2C3E50" Margin="0,0,0,10"/>

                    <ListBox ItemsSource="{Binding Logs}"
                            Height="150"
                            FontFamily="Consolas"
                            FontSize="11"/>
                </StackPanel>
            </Border>

            <!-- Explication DI -->
            <Border Background="White" CornerRadius="8" Padding="20">
                <Border.Effect>
                    <DropShadowEffect BlurRadius="10" ShadowDepth="2" Opacity="0.1"/>
                </Border.Effect>

                <StackPanel>
                    <TextBlock Text="Injection de Dépendances"
                              FontSize="16" FontWeight="SemiBold"
                              Foreground="#2C3E50" Margin="0,0,0,15"/>

                    <!-- Lifetimes -->
                    <Border Background="#E3F2FD" CornerRadius="4" Padding="10" Margin="0,0,0,10">
                        <StackPanel>
                            <TextBlock Text="Singleton" FontWeight="SemiBold" Foreground="#1565C0"/>
                            <TextBlock Text="Une seule instance pour toute l'application.&#x0a;Idéal pour: configuration, logging, cache."
                                      FontSize="11" Foreground="#0D47A1" TextWrapping="Wrap"/>
                        </StackPanel>
                    </Border>

                    <Border Background="#E8F5E9" CornerRadius="4" Padding="10" Margin="0,0,0,10">
                        <StackPanel>
                            <TextBlock Text="Scoped" FontWeight="SemiBold" Foreground="#2E7D32"/>
                            <TextBlock Text="Une instance par scope (requête web).&#x0a;Rarement utilisé en WPF desktop."
                                      FontSize="11" Foreground="#1B5E20" TextWrapping="Wrap"/>
                        </StackPanel>
                    </Border>

                    <Border Background="#FFF3E0" CornerRadius="4" Padding="10">
                        <StackPanel>
                            <TextBlock Text="Transient" FontWeight="SemiBold" Foreground="#E65100"/>
                            <TextBlock Text="Nouvelle instance à chaque résolution.&#x0a;Idéal pour: ViewModels, services légers."
                                      FontSize="11" Foreground="#BF360C" TextWrapping="Wrap"/>
                        </StackPanel>
                    </Border>

                    <!-- Avantages -->
                    <TextBlock Text="Avantages:" FontWeight="SemiBold" Margin="0,15,0,5"/>
                    <TextBlock TextWrapping="Wrap" FontSize="12" Foreground="#7F8C8D">
                        • Couplage faible (interfaces)
                        • Tests faciles (mocks)
                        • Dépendances explicites
                        • Gestion automatique du cycle de vie
                    </TextBlock>
                </StackPanel>
            </Border>
        </StackPanel>
    </Grid>

    <Window.Resources>
        <BooleanToVisibilityConverter x:Key="BoolToVis"/>
        <local:StringToVisibilityConverter x:Key="StringToVis"
                                           xmlns:local="clr-namespace:DIDemo.Converters"/>
    </Window.Resources>
</Window>
